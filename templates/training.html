<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modalit√† Allenamento</title>

    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#6366f1">
    <link rel="apple-touch-icon" href="/static/icons/icon-192x192.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="/static/training_styles.css">
</head>
<body>
    <div class="container">
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
            üåô
        </button>

        <div id="setup-screen">
            <h1>Allenamento Deputati</h1>
            
            <div class="form-group">
                <label for="game-mode-select">Scegli la Modalit√† di Gioco</label>
                <div class="custom-select">
                    <select id="game-mode-select">
                        <option value="classic">Classica (4 opzioni)</option>
                        <option value="manual">Manuale (Inserisci cognome e gruppo)</option>
                        <option value="seat">Difficile (Indovina Seggio - Scrivi)</option>
                        <option value="click-seat">Super Difficile (Clicca Seggio)</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group">
                <label for="deputy-source-select">Fonte Deputati</label>
                <div class="custom-select">
                    <select id="deputy-source-select">
                        <option value="all">Tutti i deputati (filtrati per gruppo)</option>
                        <option value="manual">Seleziona manualmente</option>
                    </select>
                </div>
            </div>

            <div id="manual-selection-controls" class="form-group hidden">
                <button class="btn-secondary-full" id="open-selection-modal-btn">Seleziona Deputati...</button>
                <p id="selected-count-info" class="info-text">0 deputati selezionati</p>
            </div>
            
            <div class="form-group" id="group-select-container">
                <label for="group-select">Scegli un Gruppo Parlamentare</label>
                <div class="custom-select">
                    <select id="group-select"></select>
                </div>
            </div>
            <div class="form-group" id="rounds-input-container">
                <label for="rounds-input">Numero di Deputati da Indovinare</label>
                <input type="number" id="rounds-input" value="10" min="1" max="100">
            </div>
            
            <div class="setup-actions">
                <button class="btn-primary" id="start-btn">Inizia Allenamento</button>
                <button class="btn-secondary-full" id="search-btn">Cerca un Deputato</button>
            </div>
            
            <p id="deputy-count-info" class="info-text"></p>
        </div>

        <div id="game-screen" class="hidden">
            <div id="game-header" class="game-header">
                <div>
                    <div id="progress-text">Domanda 1 / 10</div>
                    <div id="score-text" class="score-text">Punteggio: 0</div>
                </div>
                <button id="quit-btn" class="btn-secondary">Esci</button>
            </div>
            <div id="image-container">
                <img id="deputy-image" src="" alt="Foto del deputato">
            </div>
            <div id="answers-container">
            </div>
            <div id="feedback-text" class="feedback-text"></div>
        </div>
        
        <div id="manual-game-screen" class="hidden">
            <div id="manual-game-header" class="game-header">
                <div>
                    <div id="manual-progress-text">Domanda 1 / 10</div>
                    <div id="manual-score-text" class="score-text">Punteggio: 0</div>
                </div>
                <button id="manual-quit-btn" class="btn-secondary">Esci</button>
            </div>
            
            <div class="manual-layout-grid">
                <div id="manual-image-container">
                    <img id="manual-deputy-image" src="" alt="Foto del deputato">
                </div>
                <div class="manual-controls">
                    <div id="manual-inputs-container">
                         <input type="text" id="lastname-input" placeholder="Inserisci il cognome...">
                         <div class="custom-select" id="group-guess-wrapper">
                            <select id="group-guess-select">
                            </select>
                        </div>
                    </div>
                    <div id="hints-container">
                        <button id="hint-group-btn" class="btn-secondary">Suggerimento: Gruppo</button>
                        <button id="hint-initial-btn" class="btn-secondary">Suggerimento: Iniziale</button>
                    </div>
                    <div id="hints-display-area" class="hidden"></div>
                    <button class="btn-primary" id="submit-manual-answer-btn">Conferma Risposta</button>
                    <div id="manual-feedback-text" class="feedback-text"></div>
                </div>
            </div>
        </div>
        
        <div id="seat-game-screen" class="hidden">
            <div id="seat-game-header" class="game-header">
                <div>
                    <div id="seat-progress-text">Domanda 1 / 10</div>
                    <div id="seat-score-text" class="score-text">Punteggio: 0</div>
                </div>
                <button id="seat-quit-btn" class="btn-secondary">Esci</button>
            </div>
            
            <div class="manual-layout-grid">
                <div id="seat-image-container">
                    <img id="seat-deputy-image" src="" alt="Foto del deputato">
                </div>
                <div class="seat-controls">
                    <div id="seat-inputs-container">
                         <input type="number" id="seat-input" placeholder="Inserisci il numero seggio..." min="1" max="661">
                    </div>
                    <button class="btn-primary" id="submit-seat-answer-btn" style="margin-top: 20px;">Conferma Seggio</button>
                    <div id="seat-feedback-text" class="feedback-text"></div>
                </div>
            </div>
        </div>
        
        <div id="click-seat-game-screen" class="hidden">
            <div id="click-seat-game-header" class="game-header">
                <div>
                    <div id="click-seat-progress-text">Domanda 1 / 10</div>
                    <div id="click-seat-score-text" class="score-text">Punteggio: 0</div>
                </div>
                <button id="click-seat-quit-btn" class="btn-secondary">Esci</button>
            </div>
            
            <h2 id="click-seat-question-text" style="text-align: center; margin-bottom: 20px; font-size: 1.8rem;"></h2>
            
            <iframe id="quiz-emiciclo-iframe" src="about:blank" title="Mappa Emiciclo Quiz"></iframe>
            
            <div id="click-seat-feedback-text" class="feedback-text"></div>
        </div>


        <div id="end-screen" class="hidden">
            <h1>Sessione Terminata!</h1>
            <p id="final-score-text">Punteggio Finale: 8 / 10</p>
            
            <h3>Riepilogo Sessione</h3>
            <div id="results-summary-container">
            </div>
            
            <button class="btn-primary" id="restart-btn">Allenati Ancora</button>
        </div>
        
        <div id="search-screen" class="hidden">
            <div id="search-header">
                <h2>Cerca Deputato</h2>
                <div>
                    <button id="view-emiciclo-btn" class="btn-secondary" style="margin-right: 10px;">Visualizza Emiciclo</button>
                    <button id="search-back-btn" class="btn-secondary">Indietro</button>
                </div>
            </div>
            
            <div id="search-filters">
                <div class="form-group">
                    <label for="search-cognome-input">Cognome</label>
                    <input type="text" id="search-cognome-input" placeholder="Es. Rossi">
                </div>
                <div class="form-group">
                    <label for="search-nome-input">Nome</label>
                    <input type="text" id="search-nome-input" placeholder="Es. Mario">
                </div>
                <div class="form-group">
                    <label for="search-gruppo-select">Gruppo</label>
                    <div class="custom-select">
                        <select id="search-gruppo-select"></select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="search-committee-select">Commissione</label>
                    <div class="custom-select">
                        <select id="search-committee-select"></select>
                    </div>
                </div>
                <div class="form-group" style="grid-column: 1 / -1; margin-top: 10px;">
                    <label class="checkbox-label">
                        <input type="checkbox" id="search-show-cessati" checked>
                        Includi deputati cessati
                    </label>
                </div>
            </div>
            
            <div id="search-results-container">
            </div>
        </div>
        
        <div id="selection-screen" class="hidden">
            <div id="selection-header">
                <h2>Seleziona Deputati</h2>
                <div id="selection-header-actions">
                    <button id="selection-select-all-visible-btn" class="btn-secondary">Seleziona Visibili</button>
                    <button id="selection-deselect-all-visible-btn" class="btn-secondary">Deseleziona Visibili</button>
                    <span id="selection-counter">Selezionati: 0</span>
                    <button id="selection-done-btn" class="btn-secondary">Conferma</button>
                </div>
            </div>
            
            <div id="selection-filters">
                <div class="form-group">
                    <label for="select-cognome-input">Cognome</label>
                    <input type="text" id="select-cognome-input" placeholder="Es. Rossi">
                </div>
                <div class="form-group">
                    <label for="select-nome-input">Nome</label>
                    <input type="text" id="select-nome-input" placeholder="Es. Mario">
                </div>
                <div class="form-group">
                    <label for="select-gruppo-select">Gruppo</label>
                    <div class="custom-select">
                        <select id="select-gruppo-select"></select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="select-committee-select">Commissione</label>
                    <div class="custom-select">
                        <select id="select-committee-select"></select>
                    </div>
                </div>
                <div class="form-group" style="grid-column: 1 / -1; margin-top: 10px;">
                    <label class="checkbox-label">
                        <input type="checkbox" id="select-show-cessati" checked>
                        Includi deputati cessati
                    </label>
                </div>
            </div>
            
            <div id="selection-results-container">
            </div>
        </div>
        
        <footer class="site-footer">
            <p>
                Made with ‚ù§Ô∏è by <a href="https://github.com/Roberto2213" target="_blank" rel="noopener noreferrer">Roberto Bastevole</a>.
            </p>
            <p>Rilasciato sotto licenza CC-BY-SA-4.0 license. <a href="https://data.camera.it" target="_blank" rel="noopener noreferrer">data.camera.it</a></p>
        </footer>

    </div>

    <div id="modal-overlay" class="hidden">
        <div id="modal-content"> <button id="modal-close-btn">√ó</button>
            
            <div id="modal-info-col">
                <img id="modal-image" src="" alt="Foto deputato">
                <h3 id="modal-name">Nome Deputato</h3>
                <p id="modal-group">Gruppo Parlamentare</p>
                <p id="modal-constituency" class="modal-detail-text"></p>
                <p id="modal-gender" class="modal-detail-text"></p>
                <p id="modal-seat" class="modal-detail-text"></p>
                
                <div id="modal-committees-container" class="hidden">
                    <h4>Commissioni</h4>
                    <div id="modal-committees">
                    </div>
                </div>
            </div>
            
            <iframe id="modal-emiciclo" src="about:blank" title="Posizione Emiciclo" class="hidden"></iframe>
        </div>
    </div>
    
    <div id="emiciclo-view-overlay" class="hidden">
        <button id="emiciclo-view-close-btn">√ó</button>
        <div id="emiciclo-view-content">
            <iframe id="emiciclo-view-iframe" src="about:blank" title="Mappa Emiciclo Completo"></iframe>
            
            <div id="emiciclo-view-legend">
                <div class="group-label" id="label-fdi">Fratelli d'Italia</div>
                <div class="group-label" id="label-lega">Lega</div>
                <div class="group-label" id="label-fi">Forza Italia</div>
                <div class="group-label" id="label-nm">Noi Moderati</div>
                <div class="group-label" id="label-misto">Gruppo Misto</div>
                <div class="group-label" id="label-aziv">Azione-Italia Viva</div>
                <div class="group-label" id="label-m5s">Movimento 5 Stelle</div>
                <div class="group-label" id="label-pd">Partito Democratico</div>
                <div class="group-label" id="label-avs">Alleanza Verdi e Sinistra</div>
            </div>
        </div>
    </div>

    <audio id="audio-correct" src="/static/audio/correct.wav" preload="auto"></audio>
    <audio id="audio-incorrect" src="/static/audio/incorrect.wav" preload="auto"></audio>
    <audio id="audio-start" src="/static/audio/round_start.wav" preload="auto"></audio>

    <script src="/static/training_logic.js" defer></script>
</body>
</html>
